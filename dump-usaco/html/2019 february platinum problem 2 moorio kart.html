
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="https://www.w3.org/1999/xhtml">

<head>


 <title>USACO</title>
 <link rel="stylesheet" type="text/css" href="current/usaco.css">
 <script src="current/js/jquery.min.js"></script>
 <script src="current/js/d3.v3.min.js"></script>

<META HTTP-EQUIV="EXPIRES" CONTENT="0">
 <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
 <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    "HTML-CSS": {
	scale: 85,
	preferredFont: "STIX"
    },
  tex2jax: {
    inlineMath: [['$','$'],['\\(','\\)']],
    processEscapes: true,
    skipTags: ['pre'],
    processClass: "mathjax",
    ignoreClass: "no-mathjax"
  }
});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>

<body class="no-mathjax">
 <div align="center">
  <div class="shadow1">

   <div class="content">

  
 <a href="index.php"><img src="current/images/usaco_logo.png" height="130px" border="0px" /></a> 

    <div class="navbar" align="left" border="10px">
     <ul>
      <li><a href="index.php">Overview</a></li> 
      <li><a href="index.php?page=training">Training</a></li>
      <li><a href="index.php?page=contests">Contests</a></li>
      <li><a href="index.php?page=history">History</a></li>
      <li><a href="index.php?page=staff">Staff</a></li>
      <li><a href="index.php?page=resources">Resources</a></li>
     </ul>
    </div><br/>

   
    


<div style="position:relative; float:left; left:10px; top:-50px; width:550px;"> 
<div class="panel">

<h2> USACO 2019 February Contest, Platinum </h2>
<h2> Problem 2. Moorio Kart </h2>
 
</div>
</div>

<div align="right" style="position:relative; float:right; right:30px; top:-40px; width:350px;">

<button style="margin-bottom:6px;" type="button" onClick="window.location='index.php?page=feb19results';">Return to Problem List</button><br style="padding-top:6px"/>
Contest has ended.

</div>

<br style="clear:both" />


<div id="last-status" style="padding:10px; position:relative; float:left; left:30px; top:-45px; width:820px; border:1px solid black; background-color:#FFF; " 
	data-response-code="-1" data-sid="-1"> 
   <img src="current/images/ajax.gif"/> <p style="display:inline;"> <b>Log in to allow submissions in analysis mode</b></p>
<div id="trial-information"></div>
<p style="text-align:left;" class="mono prewrap output-data"></p>
</div>

<br style="clear:both" />

<div align="right" style="position:relative; float:right; right:40px; top:-93px; width:350px; z-index:2; padding:0px;">

<form style="padding-top:60px;" action=""> 
<select name="lang" style="background-color:#eee;" id="choose-language">
<option value='en' selected='yes'>English (en)</option>
<option value='fr'>French (fr)</option>
<option value='ka'>Georgian (ka)</option>
<option value='ru'>Russian (ru)</option>
<option value='es'>Spanish (es)</option>
</select>
</form>

</div>

<div align="left" style="position:relative; float:left; left:30px; top:-100px; width:840px; z-index:1;"> 
<div align="left" class="problem-text" style='width:800px; padding-top:10px;'>
<span id="probtext-text" class="mathjax">Bessie and Farmer John enjoy goat kart racing. The idea is very similar to
Go-Kart racing that others enjoy, except the karts are pulled by goats and the
track is made from nearby farmland. The farmland consists of $N$ meadows and $M$
roads, each connecting a pair of meadows.

<p>Bessie wants to make a course from nearby farms.  A farm is a subset of two or
more meadows within which every meadow can reach every other meadow along a 
unique sequence of roads.  

<p>The nearby farmland may contain multiple farms. Suppose there are $K$ farms.
Bessie would like to make a goat kart loop by connecting all $K$ farms by adding
$K$ roads of length $X$. Each farm should be visited exactly once and at least
one road must be traversed inside each farm.

<p>To make the course interesting for racers, the total length of the track should
be at least $Y$. Bessie wants to know the sum, over all such interesting tracks,
of the total track lengths.  A track is different from another if there are two
meadows which are adjacent (after adding the roads between farms) in one track
but not the other. Please note that only the roads chosen matter, and not the
direction the goat karts will travel along those roads.

<p><div class='prob-in-spec'><h4>INPUT FORMAT (file mooriokart.in):</h4>
The first line of input contains $N$, $M$, $X$, and $Y$ where
$1 \leq N \leq 1500$, $1 \leq M \leq N-1$, and $0 \leq X, Y \leq 2500$.

<p>Each of the $M$ following lines describe roads. The lines are of the form: $A_i$
$B_i$ $D_i$, meaning that meadows $A_i$ and $B_i$ are connected with a road of
integer length $D_i$ ($1 \leq A_i, B_i \leq N$, $0 \leq D_i \leq 2500$).  Each
meadow is incident to at least one road, and there are no cycles of roads.

<p>In at least 70% of the test cases, it is also guaranteed that $N \leq 1000$ and $Y \leq 1000$.
</div>

<p><div class='prob-out-spec'><h4>OUTPUT FORMAT (file mooriokart.out):</h4>
Output a single integer, giving the sum of track lengths over all interesting
tracks. As the sum of track lengths can be quite large, print the sum of lengths
modulo
$10^9+7$.
</div>

<p><h4>SAMPLE INPUT:</h4><pre class='in'>
5 3 1 12
1 2 3
2 3 4
4 5 6
</pre><h4>SAMPLE OUTPUT:</h4> <pre class='out'>
54
</pre>

<p>This example has 6 possible tracks

<p>1 --&gt; 2 --&gt; 4 --&gt; 5 --&gt; 1         (length 11)

<p>1 --&gt; 2 --&gt; 5 --&gt; 4 --&gt; 1         (length 11)

<p>2 --&gt; 3 --&gt; 4 --&gt; 5 --&gt; 2         (length 12)

<p>2 --&gt; 3 --&gt; 5 --&gt; 4 --&gt; 2         (length 12)

<p>1 --&gt; 2 --&gt; 3 --&gt; 4 --&gt; 5 --&gt; 1   (length 15)

<p>1 --&gt; 2 --&gt; 3 --&gt; 5 --&gt; 4 --&gt; 1   (length 15)

<p>The answer is $12+12+15+15=54$, adding up only the tracks where the length is at
least $12$.

<p>Note that for this problem, the standard time limit is increased to 3 seconds
per test case (6 seconds per case for Java and Python).

<p>
<p>Problem credits: Matt Fontaine
</span>
</div>

           Contest has ended.  No further submissions allowed.
    
</div>

<div align="left" style="position:relative; float:left; left:30px; top:-70px; width:840px;"> 

</div>

<br style="clear:both" />

<script>
 var retries = 100, timeout = 1000;

 function postback()
 { 
     var sid = $('#last-status').data('sid'); if (sid == -1) return;
     $.post('current/tpcm/status-update.php', { sid: sid }, update_response, 'json'); 
 }

 function update_response(s)
 {
     // only try a limited number of times
     if (--retries < 0) return;

     // if there is xml data, update the DOM
     if (s != null)
     {
	 $('#last-status img').attr("src","current/images/medal_none.png");
	 if (parseInt(s.cd) <= -8 && s.sc == 'status-working') { $('#last-status img').attr("src","current/images/ajax.gif"); }

         // change class and text of the response box
         $('#last-status').removeClass().addClass(s.sc);
         $('#last-status p').text(s.sr);

         // change the response code of the data section
         $('#last-status').data('response-code', parseInt(s.cd));
	 $('#last-status .output-data').hide();

	 if (s.output != null)
	 {
	     $('#last-status .output-data').show().text(s.output);
	     // if the status is in a "working" state, keep checking
	     if (parseInt($('#last-status').data('response-code')) <= -8)
		 { setTimeout(postback, timeout); timeout *= 1.1; }

	     return;
	 }

	 if (s.jd != null && s.jd.length != 0)
	     $('#trial-information').html(s.jd);
     }

     // if the status is in a "working" state, keep checking
     if (parseInt($('#last-status').data('response-code')) <= -8)
         { setTimeout(postback, timeout); timeout *= 1.1; }
 }

 $(document).ready(function(){
     $('#last-status .output-data').hide();
     $('#last-status img').attr("src","current/images/medal_none.png");
     if ($('#last-status').length) postback();

     $('.masterTooltip').hover(function(){
	 // Hover over code
	 var title = $(this).attr('title');
	 $(this).data('tipText', title).removeAttr('title');
	 $('<p class="tooltip"></p>').text(title).appendTo('body').fadeIn('fast');
     }, function() {
	 // Hover out code
	 $(this).attr('title', $(this).data('tipText'));
	 $('.tooltip').remove();
     }).mousemove(function(e) {
	 var mousex = e.pageX + 20; //Get X coordinates
	 var mousey = e.pageY + 10; //Get Y coordinates
	 $('.tooltip').css({ top: mousey, left: mousex })
     });
 });

 $('#choose-language').change(function(e){
     window.location = "index.php?page=viewproblem2&cpid=925&lang=" + $(this).val();
 });

</script>


   </div>
  </div>
 </div>

 <br style="clear:both" />

<script>(function(){if (!document.body) return;var js = "window['__CF$cv$params']={r:'86a9ee6b1b5a9c31',t:'MTcxMTQ4NTM3MC4xMjMwMDA='};_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js',document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>

</html>



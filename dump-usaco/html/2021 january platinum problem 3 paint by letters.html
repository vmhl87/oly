
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="https://www.w3.org/1999/xhtml">

<head>


 <title>USACO</title>
 <link rel="stylesheet" type="text/css" href="current/usaco.css">
 <script src="current/js/jquery.min.js"></script>
 <script src="current/js/d3.v3.min.js"></script>

<META HTTP-EQUIV="EXPIRES" CONTENT="0">
 <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
 <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    "HTML-CSS": {
	scale: 85,
	preferredFont: "STIX"
    },
  tex2jax: {
    inlineMath: [['$','$'],['\\(','\\)']],
    processEscapes: true,
    skipTags: ['pre'],
    processClass: "mathjax",
    ignoreClass: "no-mathjax"
  }
});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>

<body class="no-mathjax">
 <div align="center">
  <div class="shadow1">

   <div class="content">

  
 <a href="index.php"><img src="current/images/usaco_logo.png" height="130px" border="0px" /></a> 

    <div class="navbar" align="left" border="10px">
     <ul>
      <li><a href="index.php">Overview</a></li> 
      <li><a href="index.php?page=training">Training</a></li>
      <li><a href="index.php?page=contests">Contests</a></li>
      <li><a href="index.php?page=history">History</a></li>
      <li><a href="index.php?page=staff">Staff</a></li>
      <li><a href="index.php?page=resources">Resources</a></li>
     </ul>
    </div><br/>

   
    


<div style="position:relative; float:left; left:10px; top:-50px; width:550px;"> 
<div class="panel">

<h2> USACO 2021 January Contest, Platinum </h2>
<h2> Problem 3. Paint by Letters </h2>
 
</div>
</div>

<div align="right" style="position:relative; float:right; right:30px; top:-40px; width:350px;">

<button style="margin-bottom:6px;" type="button" onClick="window.location='index.php?page=jan21results';">Return to Problem List</button><br style="padding-top:6px"/>
Contest has ended.

</div>

<br style="clear:both" />


<div id="last-status" style="padding:10px; position:relative; float:left; left:30px; top:-45px; width:820px; border:1px solid black; background-color:#FFF; " 
	data-response-code="-1" data-sid="-1"> 
   <img src="current/images/ajax.gif"/> <p style="display:inline;"> <b>Log in to allow submissions in analysis mode</b></p>
<div id="trial-information"></div>
<p style="text-align:left;" class="mono prewrap output-data"></p>
</div>

<br style="clear:both" />

<div align="right" style="position:relative; float:right; right:40px; top:-93px; width:350px; z-index:2; padding:0px;">

<form style="padding-top:60px;" action=""> 
<select name="lang" style="background-color:#eee;" id="choose-language">
<option value='en' selected='yes'>English (en)</option>
<option value='fr'>French (fr)</option>
<option value='ru'>Russian (ru)</option>
<option value='es'>Spanish (es)</option>
<option value='zh'>Chinese (zh)</option>
</select>
</form>

</div>

<div align="left" style="position:relative; float:left; left:30px; top:-100px; width:840px; z-index:1;"> 
<div align="left" class="problem-text" style='width:800px; padding-top:10px;'>
<span id="probtext-text" class="mathjax">Bessie has recently received a painting set. The canvas can be represented as an
$N \times M$ rectangle of cells where the rows are labeled $1\ldots N$ from top
to bottom and the columns are labeled $1\ldots M$ from left to right
($1\le N,M\le 1000$). Once painted, the color of a cell can be represented by an
uppercase letter from 'A' to 'Z.'  Initially, all cells are uncolored, and a
cell cannot be painted more than once.

<p>Bessie has specified the color that she desires for each cell. She can paint a
set of cells with a single color in one stroke if the set forms a connected
component, meaning that any cell in the set can reach any other via a sequence
of adjacent cells. Two cells are considered to be adjacent if they share an
edge.

<p>For example, the $3\times 3$ canvas 

<p><pre>
AAB
BBA
BBB
</pre>

<p>can be colored in four strokes as follows:

<p><pre>
...    ..B    AAB    AAB    AAB
... -&gt; ... -&gt; ... -&gt; BB. -&gt; BBA
...    ...    ...    BBB    BBB
</pre>

<p>It is not possible to produce the end result using less than four strokes.

<p>Being an avant-garde artist, Bessie will end up painting only a subrectangle of
the canvas. Currently, she is considering $Q$ candidates ($1\le Q\le 1000$),
each of which can be represented by four integers $x_1$, $y_1$, $x_2$, and
$y_2.$ This means that the subrectangle consists of all cells with row in the
range $x_1$ to $x_2$ inclusive and column in the range $y_1$ to $y_2$ inclusive.

<p>For each candidate subrectangle, what is the minimum number of strokes needed to
paint each cell in the subrectangle with its desired color while leaving all 
cells outside the subrectangle uncolored? Note that Bessie does not actually do
any painting during this process, so the answers for each candidate are
independent. 

<p>Note: The time limit for this problem is 50 percent higher than the default,
and the memory limit is 512MB, twice the default.

<p><div class='prob-in-spec'><h4>INPUT FORMAT (input arrives from the terminal / stdin):</h4>
The first line contains $N$, $M$, and $Q$.

<p>The next $N$ lines each contain a string of $M$ uppercase characters
representing the desired colors for each row of the canvas.

<p>The next $Q$ lines each contain four space-separated integers $x_1,y_1,x_2,y_2$
representing a candidate subrectangle ($1\le x_1\le x_2\le N$,
$1\le y_1\le y_2\le M$).
</div>

<p><div class='prob-out-spec'><h4>OUTPUT FORMAT (print output to the terminal / stdout):</h4>
For each of the $Q$ candidates, output the answer on a new line.
</div>

<p><h4>SAMPLE INPUT:</h4><pre class='in'>
4 8 9
ABBAAAAA
ABAAAABA
CAADABBA
AAAAAAAA
1 1 4 8
3 5 3 8
1 3 2 4
1 4 2 5
1 1 3 3
4 4 4 4
2 6 4 8
3 5 4 6
1 6 3 8
</pre><h4>SAMPLE OUTPUT:</h4> <pre class='out'>
6
3
2
1
4
1
3
2
2
</pre>

<p>The first candidate consists of the entire canvas, which can be painted in six
strokes.

<p>The second candidate consists of the subrectangle with desired colors

<p><pre>
ABBA
</pre>

<p>and can be colored in three strokes. Note that although the cells at $(3,5)$ and
$(3,8)$ can be colored with $A$ in a single stroke if you consider the entire
canvas, this is not the case when considering only the cells within the
subrectangle.

<p><div class='prob-section'><h4>SCORING:</h4>

<p><ul><li>Test cases 1-2 satisfy $N,M\le 50$.</li><li>In test cases 3-5, the canvas contains no cycles of a single color. That is,
there does not exist a sequence of distinct cells $c_1,c_2,c_3,\ldots,c_k$  such
that all of the following conditions are satisfied:

<p><ul><li>$k&gt;2$</li><li>All of $c_1,\ldots,c_k$ have the same desired color.</li><li>$c_i$ is adjacent to $c_{i+1}$ for each $1\le i&lt;k$.</li><li>$c_k$ is adjacent to $c_1$.</li></ul>

<p>Note that the $3\times 3$ canvas above contains a cycle of a single color (the
four Bs in the bottom-left corner).</li><li>In test cases 6-8, every connected component consisting of cells with the
same desired color can be contained within a two by two square with sides
parallel to the coordinate axes. The $3\times 3$ canvas above does not satisfy
this property (the connected component with five Bs cannot be contained within a
two by two square).</li><li>In test cases 9-11, every connected component consisting of cells with the
same desired color can be contained within a three by three square with sides
parallel to the coordinate axes. The $3\times 3$ canvas above satisfies this
property.</li><li>Test cases 12-20 satisfy no additional constraints.</li></ul>

<p></div>

<p>
<p>Problem credits: Andi Qu
</span>
</div>

           Contest has ended.  No further submissions allowed.
    
</div>

<div align="left" style="position:relative; float:left; left:30px; top:-70px; width:840px;"> 

</div>

<br style="clear:both" />

<script>
 var retries = 100, timeout = 1000;

 function postback()
 { 
     var sid = $('#last-status').data('sid'); if (sid == -1) return;
     $.post('current/tpcm/status-update.php', { sid: sid }, update_response, 'json'); 
 }

 function update_response(s)
 {
     // only try a limited number of times
     if (--retries < 0) return;

     // if there is xml data, update the DOM
     if (s != null)
     {
	 $('#last-status img').attr("src","current/images/medal_none.png");
	 if (parseInt(s.cd) <= -8 && s.sc == 'status-working') { $('#last-status img').attr("src","current/images/ajax.gif"); }

         // change class and text of the response box
         $('#last-status').removeClass().addClass(s.sc);
         $('#last-status p').text(s.sr);

         // change the response code of the data section
         $('#last-status').data('response-code', parseInt(s.cd));
	 $('#last-status .output-data').hide();

	 if (s.output != null)
	 {
	     $('#last-status .output-data').show().text(s.output);
	     // if the status is in a "working" state, keep checking
	     if (parseInt($('#last-status').data('response-code')) <= -8)
		 { setTimeout(postback, timeout); timeout *= 1.1; }

	     return;
	 }

	 if (s.jd != null && s.jd.length != 0)
	     $('#trial-information').html(s.jd);
     }

     // if the status is in a "working" state, keep checking
     if (parseInt($('#last-status').data('response-code')) <= -8)
         { setTimeout(postback, timeout); timeout *= 1.1; }
 }

 $(document).ready(function(){
     $('#last-status .output-data').hide();
     $('#last-status img').attr("src","current/images/medal_none.png");
     if ($('#last-status').length) postback();

     $('.masterTooltip').hover(function(){
	 // Hover over code
	 var title = $(this).attr('title');
	 $(this).data('tipText', title).removeAttr('title');
	 $('<p class="tooltip"></p>').text(title).appendTo('body').fadeIn('fast');
     }, function() {
	 // Hover out code
	 $(this).attr('title', $(this).data('tipText'));
	 $('.tooltip').remove();
     }).mousemove(function(e) {
	 var mousex = e.pageX + 20; //Get X coordinates
	 var mousey = e.pageY + 10; //Get Y coordinates
	 $('.tooltip').css({ top: mousey, left: mousex })
     });
 });

 $('#choose-language').change(function(e){
     window.location = "index.php?page=viewproblem2&cpid=1094&lang=" + $(this).val();
 });

</script>


   </div>
  </div>
 </div>

 <br style="clear:both" />

<script>(function(){if (!document.body) return;var js = "window['__CF$cv$params']={r:'86a9eee8ae4981c9',t:'MTcxMTQ4NTM5MC4yMTEwMDA='};_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js',document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>

</html>



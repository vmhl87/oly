
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="https://www.w3.org/1999/xhtml">

<head>


 <title>USACO</title>
 <link rel="stylesheet" type="text/css" href="current/usaco.css">
 <script src="current/js/jquery.min.js"></script>
 <script src="current/js/d3.v3.min.js"></script>

<META HTTP-EQUIV="EXPIRES" CONTENT="0">
 <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
 <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    "HTML-CSS": {
	scale: 85,
	preferredFont: "STIX"
    },
  tex2jax: {
    inlineMath: [['$','$'],['\\(','\\)']],
    processEscapes: true,
    skipTags: ['pre'],
    processClass: "mathjax",
    ignoreClass: "no-mathjax"
  }
});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>

<body class="no-mathjax">
 <div align="center">
  <div class="shadow1">

   <div class="content">

  
 <a href="index.php"><img src="current/images/usaco_logo.png" height="130px" border="0px" /></a> 

    <div class="navbar" align="left" border="10px">
     <ul>
      <li><a href="index.php">Overview</a></li> 
      <li><a href="index.php?page=training">Training</a></li>
      <li><a href="index.php?page=contests">Contests</a></li>
      <li><a href="index.php?page=history">History</a></li>
      <li><a href="index.php?page=staff">Staff</a></li>
      <li><a href="index.php?page=resources">Resources</a></li>
     </ul>
    </div><br/>

   
    


<div style="position:relative; float:left; left:10px; top:-50px; width:550px;"> 
<div class="panel">

<h2> USACO 2018 January Contest, Gold </h2>
<h2> Problem 1. MooTube </h2>
 
</div>
</div>

<div align="right" style="position:relative; float:right; right:30px; top:-40px; width:350px;">

<button style="margin-bottom:6px;" type="button" onClick="window.location='index.php?page=jan18results';">Return to Problem List</button><br style="padding-top:6px"/>
Contest has ended.

</div>

<br style="clear:both" />


<div id="last-status" style="padding:10px; position:relative; float:left; left:30px; top:-45px; width:820px; border:1px solid black; background-color:#FFF; " 
	data-response-code="-1" data-sid="-1"> 
   <img src="current/images/ajax.gif"/> <p style="display:inline;"> <b>Log in to allow submissions in analysis mode</b></p>
<div id="trial-information"></div>
<p style="text-align:left;" class="mono prewrap output-data"></p>
</div>

<br style="clear:both" />

<div align="right" style="position:relative; float:right; right:40px; top:-93px; width:350px; z-index:2; padding:0px;">

<form style="padding-top:60px;" action=""> 
<select name="lang" style="background-color:#eee;" id="choose-language">
<option value='en' selected='yes'>English (en)</option>
<option value='hy'>Armenian (hy)</option>
<option value='fr'>French (fr)</option>
<option value='ka'>Georgian (ka)</option>
<option value='ru'>Russian (ru)</option>
<option value='es'>Spanish (es)</option>
</select>
</form>

</div>

<div align="left" style="position:relative; float:left; left:30px; top:-100px; width:840px; z-index:1;"> 
<div align="left" class="problem-text" style='width:800px; padding-top:10px;'>
<span id="probtext-text" class="mathjax">In his spare time, Farmer John has created a new video-sharing service, which he
names MooTube.  On MooTube, Farmer John's cows can record, share, and discover
many amusing videos.  His cows already have posted $N$ videos
($1 \leq N \leq 100,000$), conveniently numbered $1 \ldots N$.  However, FJ can't
quite figure out how to help his cows find new videos they might like.

<p>FJ wants to create a list of "suggested videos" for every MooTube video.  This
way, cows will be recommended the videos most relevant to the ones they already
watch.

<p>FJ devises a metric of "relevance," which determines, as the name suggests, how
relevant two videos are to each other.  He picks $N-1$ pairs of videos and
manually computes their pairwise relevance.  Then, FJ visualizes his videos as a
network, where each video is a node and the $N-1$ pairs of videos he manually
considered are connected.  Conveniently, FJ has picked his $N-1$ pairs so that
any video can be  reached from any other video along a path of connections in
exactly one way. FJ decides that the relevance of any pair of videos should be
defined as the minimum relevance of any connection along this path.  

<p>Farmer John wants to pick a value $K$ so that next to any given MooTube video,
all other videos with relevance at least $K$ to that video will be suggested. 
However, FJ is worried that too many videos will be suggested to his cows, which
could distract them from milk production!  Therefore, he wants to carefully set
an appropriate value of $K$.  Farmer John would like your help answering a
number of questions about the suggested videos for certain values of $K$.

<p><div class='prob-in-spec'><h4>INPUT FORMAT (file mootube.in):</h4>
The first line of input contains $N$ and $Q$ ($1 \leq Q \leq 100,000$).

<p>The next $N-1$ lines each describe a pair of videos FJ manually compares.  Each
line includes three integers $p_i$, $q_i$, and $r_i$
($1 \leq p_i, q_i \leq N, 1 \leq r_i \leq 1,000,000,000$), indicating that
videos $p_i$ and $q_i$ are connected with relevance $r_i$.  

<p>The next $Q$ lines describe Farmer John's $Q$ questions.  Each line contains two
integers, $k_i$ and $v_i$ ($1 \leq k_i \leq 1,000,000,000, 1 \leq v_i \leq N$),
indicating that FJ's $i$th question asks how many videos will be suggested to
viewers of video $v_i$ if $K = k_i$.
</div>

<p><div class='prob-out-spec'><h4>OUTPUT FORMAT (file mootube.out):</h4>
Output $Q$ lines.  On line $i$, output the answer to FJ's $i$th question.
</div>

<p><h4>SAMPLE INPUT:</h4><pre class='in'>
4 3
1 2 3
2 3 2
2 4 4
1 2
4 1
3 1
</pre><h4>SAMPLE OUTPUT:</h4> <pre class='out'>
3
0
2
</pre>

<p>Farmer John finds that videos one and two have relevance three, that videos two
and three have relevance two, and that videos two and four have relevance four. 
Based on this, videos one and three have relevance min(3, 2) = 2, videos one and
four have relevance min(3, 4) = 3, and videos three and four have relevance
min(2, 4) = 2.

<p>Farmer John wants to know how many videos will be suggested from video two if
$K=1$, from video one if $K=3$, and from video one if $K=4$.  We see that with
$K=1$, videos 1, 3, and 4 will be suggested on video two.  With $K=4$, no videos
will be suggested from video one.  With $K=3$, however, videos 2 and 4 will be
suggested from video one.

<p>
<p>Problem credits: Jay Leeds
</span>
</div>

           Contest has ended.  No further submissions allowed.
    
</div>

<div align="left" style="position:relative; float:left; left:30px; top:-70px; width:840px;"> 

</div>

<br style="clear:both" />

<script>
 var retries = 100, timeout = 1000;

 function postback()
 { 
     var sid = $('#last-status').data('sid'); if (sid == -1) return;
     $.post('current/tpcm/status-update.php', { sid: sid }, update_response, 'json'); 
 }

 function update_response(s)
 {
     // only try a limited number of times
     if (--retries < 0) return;

     // if there is xml data, update the DOM
     if (s != null)
     {
	 $('#last-status img').attr("src","current/images/medal_none.png");
	 if (parseInt(s.cd) <= -8 && s.sc == 'status-working') { $('#last-status img').attr("src","current/images/ajax.gif"); }

         // change class and text of the response box
         $('#last-status').removeClass().addClass(s.sc);
         $('#last-status p').text(s.sr);

         // change the response code of the data section
         $('#last-status').data('response-code', parseInt(s.cd));
	 $('#last-status .output-data').hide();

	 if (s.output != null)
	 {
	     $('#last-status .output-data').show().text(s.output);
	     // if the status is in a "working" state, keep checking
	     if (parseInt($('#last-status').data('response-code')) <= -8)
		 { setTimeout(postback, timeout); timeout *= 1.1; }

	     return;
	 }

	 if (s.jd != null && s.jd.length != 0)
	     $('#trial-information').html(s.jd);
     }

     // if the status is in a "working" state, keep checking
     if (parseInt($('#last-status').data('response-code')) <= -8)
         { setTimeout(postback, timeout); timeout *= 1.1; }
 }

 $(document).ready(function(){
     $('#last-status .output-data').hide();
     $('#last-status img').attr("src","current/images/medal_none.png");
     if ($('#last-status').length) postback();

     $('.masterTooltip').hover(function(){
	 // Hover over code
	 var title = $(this).attr('title');
	 $(this).data('tipText', title).removeAttr('title');
	 $('<p class="tooltip"></p>').text(title).appendTo('body').fadeIn('fast');
     }, function() {
	 // Hover out code
	 $(this).attr('title', $(this).data('tipText'));
	 $('.tooltip').remove();
     }).mousemove(function(e) {
	 var mousex = e.pageX + 20; //Get X coordinates
	 var mousey = e.pageY + 10; //Get Y coordinates
	 $('.tooltip').css({ top: mousey, left: mousex })
     });
 });

 $('#choose-language').change(function(e){
     window.location = "index.php?page=viewproblem2&cpid=789&lang=" + $(this).val();
 });

</script>


   </div>
  </div>
 </div>

 <br style="clear:both" />

<script>(function(){if (!document.body) return;var js = "window['__CF$cv$params']={r:'86a9ee0c9c069c66',t:'MTcxMTQ4NTM1NS4wMzUwMDA='};_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js',document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>

</html>



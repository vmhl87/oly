input n, cows (running count e_count, n_count)

init arrays e_cows,n_cows (length e_count, n_count)
for c in cows:
	if e: push to e_cows
	else push to n_cows

sort arrays, preserve id

array ret

for each e_cow:
	search against n_cows past n_index (if upper bound, bound)
		if would hit:
			calculate length of path
			set upper bound of other cow
	store length

for each n_cow:
	similar as for each e_cow

for index in cows:
	print ret[index]
